# セキュリティについて

セキュリティ、認証、認可の扱い方はいろいろあります。

そして、普通は複雑で「難しい」話題です。

多くのフレームワークやシステムでは、セキュリティや認証を扱うだけでも、かなりの労力とコードが必要になります。（多くの場合、書かれているコードの50%以上になることもあります）。

**FastAPI** は、すべてのセキュリティ仕様を勉強したり学習したりする必要はなく、標準的な方法で **セキュリティ** を簡単かつ迅速に扱うためのツールをいくつか提供します。

しかし、まずは小さな概念を確認してみましょう。

## 急いでいますか？

これらのどの用語も気にせず、ユーザー名とパスワードに基づいた認証でセキュリティを追加する必要がある場合は、次の章にスキップしてください。

## OAuth2

OAuth2は、認証と認可を処理するための幾つかの方法を定義した仕様です。

かなり充実した仕様で、いくつかの複雑なユースケースをカバーしています。

それは「サードパーティ」を使用して認証する方法も含まれています。

これは、「Facebook、Google、Twitter、GitHubでログイン」のある全てのシステムが使っているものです。

### OAuth 1

Oauth1というものがありましたが、これはOAuth2とは大きく異なり、通信をどのように暗号化するかという仕様が直接含まれているため、より複雑なものになっていました。

今ではあまり使われておらず、人気もありません。

OAuth2は通信をどのように暗号化するかを指定しておらず、アプリケーションがHTTPSで提供されていることを期待しています。

!!! tip "豆知識"
    **デプロイ**についてのセクションでは、TraefikとLet's Encryptを使用して、無料でHTTPSを設定する方法を紹介しています。


## OpenID Connect

OpenID Connectは、**OAuth2** をベースにした別の仕様です。

これはOAuth2を拡張して、OAuth2の中で比較的曖昧なものをいくつか指定して、より相互運用性を高めようとしているだけです。

例えば、GoogleログインはOpenID Connectを使用しています。（これはOAuth2を使用しています）。

しかし、FacebookログインはOpenID Connectをサポートしていません。OAuth2の独自のフレーバーを使用しています。

### OpenID （"OpenID Connect"ではなく）

「OpenID」という仕様もありました。これは**OpenID Connect** と同じことを解決しようとしていましたが、OAuth2をベースにしていませんでした。

そのため、完全な追加システムでした。

今ではあまり使われておらず、人気もありません。

## OpenAPI

OpenAPI（以前はSwaggerとして知られていた）は、APIを構築するためのオープンな仕様です。（現在はLinux Foundationの一部となっています）。

**FastAPI** は **OpenAPI** をベースにしています。

このことが、自動対話型のドキュメントインターフェース、コード生成などを複数持つことを可能にしています。

OpenAPIには、複数のセキュリティ「スキーム」を定義する方法があります。

それらを使うことによって、これらの対話型ドキュメントシステムを含む標準ベースのツールのすべてを活用することができます。

OpenAPIは以下のセキュリティスキームを定義しています:

* `apiKey`: 以下から取得できるアプリケーション固有のキーです:
    * クエリパラメータ
    * ヘッダ
    * クッキー
* `http`: 以下を含む標準的なHTTP認証システムです:
    * `bearer`: ヘッダ`Authorization`に`Bearer`とトークンを加えた値を指定します。これはOAuth2から継承されます。
    * HTTPベーシック認証。
    * HTTPダイジェストなど。
* `oauth2`: OAuth2でセキュリティを扱う方法（「フロー」と呼ばれる）のすべてを指定します。
    * これらのフローのいくつかは、OAuth2.0認証プロバイダ（Google、Facebook、Twitter、GitHubなど）を構築するのに適しています。
        * `implicit`
        * `clientCredentials`
        * `authorizationCode`
    * しかし、同じアプリケーションで直接認証を処理するために完璧に使用できる特定の「フロー」があります:
        * `password`: 次の章ではその例を紹介します。
* `openIdConnect`: は、OAuth2認証データを自動的に発見する方法を定義する方法を持っています。
    * この自動検出は、OpenID Connectの仕様で定義されているものです。


!!! tip "豆知識"
    Google、Facebook、Twitter、GitHubなどの他の認証・認証プロバイダを統合することも可能で、比較的簡単です。

    最も複雑な問題は、これらのような認証/認証プロバイダを構築することですが、**FastAPI** は、重い仕事をしながら、それを簡単に行うためのツールを提供します。

## **FastAPI**ユーティリティ

FastAPIは、`fastapi.security`モジュールの中で、これらのセキュリティメカニズムの使用を簡単にするために、これらのセキュリティスキームのそれぞれにいくつかのツールを提供しています。

次の章では、**FastAPI** によって提供されるツールを使用してAPIにセキュリティを追加する方法を説明します。

また、それがどのようにして対話型のドキュメントシステムに自動的に統合されるのかを見ることができます。
